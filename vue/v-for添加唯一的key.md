### v-foræ·»åŠ å”¯ä¸€çš„key

æ¥æºï¼š[ä¸ºä»€ä¹ˆä½¿ç”¨v-foræ—¶å¿…é¡»æ·»åŠ å”¯ä¸€çš„key?](https://www.jianshu.com/p/342e2d587e69#:~:text=%E4%BD%BF%E7%94%A8%20v-for%20%E6%9B%B4%E6%96%B0%E5%B7%B2%E6%B8%B2%E6%9F%93%E7%9A%84%E5%85%83%E7%B4%A0%E5%88%97%E8%A1%A8%E6%97%B6%2C%E9%BB%98%E8%AE%A4%E7%94%A8%20%E5%B0%B1%E5%9C%B0%E5%A4%8D%E7%94%A8,%E7%AD%96%E7%95%A5%3B%E5%88%97%E8%A1%A8%E6%95%B0%E6%8D%AE%E4%BF%AE%E6%94%B9%E7%9A%84%E6%97%B6%E5%80%99%2C%E4%BB%96%E4%BC%9A%E6%A0%B9%E6%8D%AEkey%E5%80%BC%E5%8E%BB%E5%88%A4%E6%96%AD%E6%9F%90%E4%B8%AA%E5%80%BC%E6%98%AF%E5%90%A6%E4%BF%AE%E6%94%B9%2C%E5%A6%82%E6%9E%9C%E4%BF%AE%E6%94%B9%2C%E5%88%99%E9%87%8D%E6%96%B0%E6%B8%B2%E6%9F%93%E8%BF%99%E4%B8%80%E9%A1%B9%2C%E5%90%A6%E5%88%99%E5%A4%8D%E7%94%A8%E4%B9%8B%E5%89%8D%E7%9A%84%E5%85%83%E7%B4%A0%3B%20%E6%88%91%E4%BB%AC%E5%9C%A8%E4%BD%BF%E7%94%A8%E7%9A%84%E4%BD%BF%E7%94%A8%E7%BB%8F%E5%B8%B8%E4%BC%9A%E4%BD%BF%E7%94%A8%20index%20%28%E5%8D%B3%E6%95%B0%E7%BB%84%E7%9A%84%E4%B8%8B%E6%A0%87%29%E6%9D%A5%E4%BD%9C%E4%B8%BA%20key%2C%E4%BD%86%E5%85%B6%E5%AE%9E%E8%BF%99%E6%98%AF%E4%B8%8D%E6%8E%A8%E8%8D%90%E7%9A%84%E4%B8%80%E7%A7%8D%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95%3B)ã€[æ·±åº¦å‰–æï¼šå¦‚ä½•å®ç°ä¸€ä¸ª Virtual DOM ç®—æ³•](https://github.com/livoras/blog/issues/13)

ä¸»è¦è€ƒç‚¹æ˜¯**è™šæ‹Ÿdomã€diffç®—æ³•**ã€‚

#### å‰è¨€

ä½¿ç”¨`v-for`æ›´æ–°å·²æ¸²æŸ“çš„å…ƒç´ åˆ—è¡¨æ—¶,é»˜è®¤ç”¨`å°±åœ°å¤ç”¨`ç­–ç•¥;åˆ—è¡¨æ•°æ®ä¿®æ”¹çš„æ—¶å€™,ä»–ä¼šæ ¹æ®keyå€¼å»åˆ¤æ–­æŸä¸ªå€¼æ˜¯å¦ä¿®æ”¹,å¦‚æœä¿®æ”¹,åˆ™é‡æ–°æ¸²æŸ“è¿™ä¸€é¡¹,å¦åˆ™å¤ç”¨ä¹‹å‰çš„å…ƒç´ ;
 æˆ‘ä»¬åœ¨ä½¿ç”¨çš„ä½¿ç”¨ç»å¸¸ä¼šä½¿ç”¨`index`(å³æ•°ç»„çš„ä¸‹æ ‡)æ¥ä½œä¸º`key`,ä½†å…¶å®è¿™æ˜¯ä¸æ¨èçš„ä¸€ç§ä½¿ç”¨æ–¹æ³•;

ä¸¾ä¸ªğŸŒ°

```javascript
const list = [
    {
        id: 1,
        name: 'test1',
    },
    {
        id: 2,
        name: 'test2',
    },
    {
        id: 3,
        name: 'test3',
    },
]

<div v-for="(item, index) in list" :key="index" >{{item.name}}</div>
```

ä¸Šé¢è¿™ç§æ˜¯æˆ‘ä»¬åšé¡¹ç›®ä¸­å¸¸ç”¨åˆ°çš„ä¸€ç§åœºæ™¯ï¼Œå› ä¸ºä¸åŠ key,vueç°åœ¨ç›´æ¥æŠ¥é”™ï¼Œæ‰€ä»¥æˆ‘ä½¿ç”¨indexä½œä¸ºkeyï¼›ä¸‹é¢åˆ—ä¸¾ä¸¤ç§å¸¸è§çš„æ•°æ®æ›´æ–°æƒ…å†µï¼š

#### 1ã€åœ¨æœ€åä¸€æ¡æ•°æ®åå†åŠ ä¸€æ¡æ•°æ®

```javascript
const list = [
    {
        id: 1,
        name: 'test1',
    },
    {
        id: 2,
        name: 'test2',
    },
    {
        id: 3,
        name: 'test3',
    },
    {
        id: 4,
        name: 'æˆ‘æ˜¯åœ¨æœ€åæ·»åŠ çš„ä¸€æ¡æ•°æ®',
    },
]

```

æ­¤æ—¶å‰ä¸‰æ¡æ•°æ®ç›´æ¥å¤ç”¨ä¹‹å‰çš„ï¼Œæ–°æ¸²æŸ“æœ€åä¸€æ¡æ•°æ®ï¼Œæ­¤æ—¶ç”¨`index`ä½œä¸º`key`ï¼Œæ²¡æœ‰ä»»ä½•é—®é¢˜ã€‚

#### 2ã€åœ¨ä¸­é—´æ’å…¥ä¸€æ¡æ•°æ®

```javascript
const list = [
    {
        id: 1,
        name: 'test1',
    },
    {
        id: 4,
        name: 'æˆ‘æ˜¯æ’é˜Ÿçš„é‚£æ¡æ•°æ®',
    }
    {
        id: 2,
        name: 'test2',
    },
    {
        id: 3,
        name: 'test3',
    },
]
```

æ­¤æ—¶æ›´æ–°æ¸²æŸ“æ•°æ®ï¼Œé€šè¿‡`index`å®šä¹‰çš„`key`å»è¿›è¡Œå‰åæ•°æ®çš„å¯¹æ¯”ï¼Œå‘ç°

```javascript
ä¹‹å‰çš„æ•°æ®                         ä¹‹åçš„æ•°æ®

key: 0  index: 0 name: test1     key: 0  index: 0 name: test1
key: 1  index: 1 name: test2     key: 1  index: 1 name: æˆ‘æ˜¯æ’é˜Ÿçš„é‚£æ¡æ•°æ®
key: 2  index: 2 name: test3     key: 2  index: 2 name: test2
                                 key: 3  index: 3 name: test3
```

é™¤äº†ç¬¬ä¸€ä¸ªæ•°æ®å¯ä»¥å¤ç”¨ä¹‹å‰çš„ä¹‹å¤–ï¼Œå¦å¤–ä¸‰æ¡æ•°æ®éƒ½éœ€è¦é‡æ–°æ¸²æŸ“ã€‚

æœ€å¥½çš„åŠæ³•æ˜¯ä½¿ç”¨æ•°ç»„ä¸­ä¸ä¼šå˜åŒ–çš„é‚£ä¸€é¡¹ä½œä¸º`key`å€¼ï¼Œå¯¹åº”åˆ°é¡¹ç›®ä¸­çš„idï¼Œå³æ¯æ¡æ•°æ®éƒ½æœ‰ä¸€ä¸ªå”¯ä¸€çš„`id`ï¼Œæ¥æ ‡è¯†è¿™æ¡æ•°æ®çš„å”¯ä¸€æ€§ã€‚

ä½¿ç”¨`id`ä½œä¸º`key`å€¼ï¼Œæˆ‘ä»¬å†æ¥å¯¹æ¯”ä¸€ä¸‹å‘ä¸­é—´æ’å…¥ä¸€æ¡æ•°æ®ï¼Œæ­¤æ—¶ä¼šæ€ä¹ˆå»æ¸²æŸ“

```javascript
ä¹‹å‰çš„æ•°æ®                               ä¹‹åçš„æ•°æ®

key: 1  id: 1 index: 0 name: test1     key: 1  id: 1 index: 0  name: test1
key: 2  id: 2 index: 1 name: test2     key: 4  id: 4 index: 1  name: æˆ‘æ˜¯æ’é˜Ÿçš„é‚£æ¡æ•°æ®
key: 3  id: 3 index: 2 name: test3     key: 2  id: 2 index: 2  name: test2
                                       key: 3  id: 3 index: 3  name: test3
```

åªè¦æ–°æ¸²æŸ“è¿™ä¸€æ¡æ•°æ®å³å¯ï¼Œå…¶ä»–éƒ½æ˜¯å°±å¤ç”¨ä¹‹å‰çš„ã€‚

çœŸæ­£çš„åŸå› æ˜¯æ¥æºäº**è™šæ‹ŸDOMçš„Diffç®—æ³•**ã€‚ç®—æ³•å¤§è‡´æµç¨‹å¦‚ä¸‹ï¼š

![img](https:////upload-images.jianshu.io/upload_images/3297464-ee627869a6714336.jpg?imageMogr2/auto-orient/strip|imageView2/2/w/477)

æˆ‘ä»¬å¸Œæœ›å¯ä»¥åœ¨Bå’ŒCä¹‹é—´åŠ ä¸€ä¸ªFï¼ŒDiffç®—æ³•é»˜è®¤æ‰§è¡Œèµ·æ¥æ˜¯è¿™æ ·çš„ï¼š

![img](https:////upload-images.jianshu.io/upload_images/3297464-d912523aac5fd108.jpg?imageMogr2/auto-orient/strip|imageView2/2/w/572)

å³æŠŠCæ›´æ–°æˆFï¼ŒDæ›´æ–°æˆCï¼ŒEæ›´æ–°æˆDï¼Œæœ€åå†æ’å…¥Eï¼Œæ˜¯ä¸æ˜¯å¾ˆæ²¡æœ‰æ•ˆç‡ï¼Ÿ 

æ‰€ä»¥æˆ‘ä»¬éœ€è¦ä½¿ç”¨keyæ¥ç»™æ¯ä¸ªèŠ‚ç‚¹åšä¸€ä¸ªå”¯ä¸€æ ‡è¯†ï¼ŒDiffç®—æ³•å°±å¯ä»¥æ­£ç¡®çš„è¯†åˆ«æ­¤èŠ‚ç‚¹ï¼Œæ‰¾åˆ°æ­£ç¡®çš„ä½ç½®åŒºæ’å…¥æ–°çš„èŠ‚ç‚¹ã€‚

![img](https:////upload-images.jianshu.io/upload_images/3297464-650689b4bd4b9eb6.jpg?imageMogr2/auto-orient/strip|imageView2/2/w/452)

æ‰€ä»¥ä¸€å¥è¯ï¼Œkeyçš„ä½œç”¨ä¸»è¦æ˜¯ä¸ºäº†**é«˜æ•ˆçš„æ›´æ–°è™šæ‹ŸDOMï¼Œæå‡æ¸²æŸ“æ•ˆç‡**ã€‚å¦å¤–vueä¸­åœ¨ä½¿ç”¨ç›¸åŒæ ‡ç­¾åå…ƒç´ çš„è¿‡æ¸¡åˆ‡æ¢æ—¶ï¼Œä¹Ÿä¼šä½¿ç”¨åˆ°keyå±æ€§ï¼Œå…¶ç›®çš„ä¹Ÿæ˜¯ä¸ºäº†è®©vueå¯ä»¥åŒºåˆ†å®ƒä»¬ï¼Œå¦åˆ™vueåªä¼šæ›¿æ¢å…¶å†…éƒ¨å±æ€§è€Œä¸ä¼šè§¦å‘è¿‡æ¸¡æ•ˆæœã€‚

**ç®—æ³•å®ç° ï¼š**

- æ­¥éª¤ä¸€ï¼šç”¨JSå¯¹è±¡æ¨¡æ‹ŸDOMæ ‘
- æ­¥éª¤äºŒï¼šæ¯”è¾ƒä¸¤æ£µè™šæ‹ŸDOMæ ‘çš„å·®å¼‚
- æ­¥éª¤ä¸‰ï¼šæŠŠå·®å¼‚åº”ç”¨åˆ°çœŸæ­£çš„DOMæ ‘ä¸Š